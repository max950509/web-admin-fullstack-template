# 前端架构

前端使用 React 18 + Ant Design Pro Components，强调“统一 schema + 配置驱动”，并在路由层实现多标签与页面缓存。

## 1. 路由与权限

- 路由集中在 `routes.tsx`
- `handle.code` 绑定权限（如 `read:account`）
- `handle.fixed` 设置固定标签（如首页）
- `handle.noKeepAlive` 关闭页面缓存

## 2. 多标签与 KeepAlive

核心入口：`router/index.tsx` + `components/layouts/RouteTabs.tsx`

- `wrapKeepAlive` 为页面路由包裹 `<KeepAlive>`
- `RouteTabs` 监听路由变化自动加 Tab
- 关闭 Tab 同时 `drop` 缓存，刷新 Tab 调 `refresh`

详细实现可见：《多标签与KeepAlive.md》

## 3. CRUD Schema 体系

核心思想：**同一套 columns 同时驱动表格、表单、详情**。

关键约束：\n
- `BASE_COLS` 只描述字段语义\n
- `patchSchema` 基于 dataIndex 做差异化覆盖\n
- `BaseProTable` 负责分页与请求规范化\n

账号管理页面结构示例：\n

- `BASE_COLS`：字段最小定义\n
- `CREATE_FORM_COLS`：新增时强制密码\n
- `UPDATE_FORM_COLS`：编辑时隐藏密码\n
- `DESC_COLUMNS`：详情弹窗复用\n

## 4. 统一请求层

- Axios 实例统一注入 token\n
- 过期自动跳转登录\n
- 数组参数支持 `roleIds=1&roleIds=2`\n

## 5. 组件化拆分

- `BaseProTable`：表格骨架\n
- `DescModal`：详情弹窗\n
- `RolePermissionEditor`：角色授权树\n
- `RouteTabs`：标签页容器\n

## 6. 设计取向

- schema 驱动优先于 JSX\n
- CRUD 页面风格统一，维护成本低\n
- 一处修改同步影响表单 / 列表 / 详情\n

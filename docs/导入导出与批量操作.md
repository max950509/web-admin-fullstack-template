# 导入导出与批量操作

本模板以“账号管理”为例落地了 CSV/Excel 导入、模板下载与批量删除能力，并将导出升级为异步任务。

## 1. 模板下载

- 接口：`GET /users/template?format=csv|xlsx`
- 模板字段：
  - `账号名`
  - `密码`
  - `角色(逗号分隔)`

适合业务字段少、模板简单的场景；复杂模板可切换为静态文件。

## 2. 批量删除

- 接口：`POST /users/batch-delete`
- 请求体：`{ ids: number[] }`
- 前端：表格 `rowSelection` 统一控制

## 3. 数据导入

- 接口：`POST /users/import?mode=insert|upsert`
- 文件类型：`.csv` / `.xlsx`
- 校验逻辑：
  - 账号名 / 密码 / 角色必填
  - 密码最小长度 6
  - 角色名必须存在
- 返回：成功/失败数量 + 行级错误

`mode`：

- `insert`：仅新增，存在则报错
- `upsert`：存在则更新

## 4. 导出方式（异步任务）

导出不直接返回文件，而是创建导出任务：

- `POST /export-tasks` 创建任务
- 导出结果在“导出任务”页面下载

导出任务细节见：《导出任务.md》


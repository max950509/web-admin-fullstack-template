# 权限设计

权限系统以“动作 + 资源”作为最小授权单元，并支持菜单/页面/操作三层语义，前后端统一描述。

## 1. 权限模型

`Permission` 核心字段：

- `action`: create/read/update/delete/menu
- `resource`: account / role / permission ...
- `type`: menu | page | action
- `parentId`: 形成权限树
- `sort`: 排序

`Role` 与 `Permission` 多对多关系：

- `RolePermission` 作为关联表
- 用户通过 `UserRole` 绑定角色

## 2. 鉴权流程

后端：

- `@CheckPermissions(action, resource)` 装饰器定义权限
- `PermissionsGuard` 读取元数据
- 若用户具备对应权限或角色为 `admin` -> 允许

前端：

- 路由 `handle.code = "read:account"`
- 前端菜单与按钮基于权限树渲染

## 3. 菜单 / 页面 / 操作

- `menu`：仅用于目录结构，不参与勾选
- `page`：页面入口权限
- `action`：按钮级权限

示例（账号管理）：

- menu：系统管理
- page：账号管理
- action：新增账号 / 编辑账号 / 删除账号

## 4. Admin 角色策略

- `admin` 角色可视为默认全量权限
- 权限树依然保留，可用于审计或 UI 展示

## 5. 设计取向

- **后端强约束**：所有接口都通过 `CheckPermissions` 标记
- **前端轻渲染**：菜单与按钮随权限动态渲染
- **树形表达**：可用于“角色授权”树形勾选

